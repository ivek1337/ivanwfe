workflows:
  ios_unsigned_build:
    steps:
      - git::https://github.com/bitrise-io/steps-git-clone.git@v12.3.7: {}
      - script@1:
          title: Activate FlutterFire CLI and Melos
          inputs:
            - content: |-
                #!/bin/bash
                dart pub global activate flutterfire_cli || echo "FlutterFire CLI activation failed, continuing..."
                dart pub global activate melos || echo "Melos activation failed, continuing..."
                melos bootstrap || echo "Melos bootstrap failed, continuing..."
      - flutter-install@0: {}
      - flutter-pub-get@0: {}
      - cocoapods-install@1:
          title: Install CocoaPods dependencies
      - flutter-analyze@0: {}
      - flutter-test@0:
          continue_on_error: true
      - flutter-build@0:
          inputs:
            platform: ios
            ios_export_method: 'development'
            ios_code_signing_identity: ''
            ios_code_signing_required: 'no'
            ios_export_options: |
              <plist version="1.0">
              <dict>
                <key>compileBitcode</key>
                <false/>
                <key>method</key>
                <string>development</string>
              </dict>
              </plist>
            flutter_build_ios_no_codesign: 'true'
            release: 'true'
      - deploy-to-bitrise-io@1: {}
